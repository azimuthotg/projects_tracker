# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£
## ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ó‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°

**‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô:** 1.0
**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:** 19 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569
**‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥:** ‡∏á‡∏≤‡∏ô‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£

---

## ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

1. [‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö](#1-‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö)
2. [‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°](#2-‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°)
3. [‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏£‡∏∞‡∏ö‡∏ö](#3-‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏£‡∏∞‡∏ö‡∏ö)
4. [‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á](#4-‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á)
5. [‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment](#5-‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤-environment)
6. [‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Windows Service](#6-‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á-windows-service)
7. [‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ IIS](#7-‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤-iis)
8. [‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö](#8-‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö)
9. [‡∏Å‡∏≤‡∏£‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤](#9-‡∏Å‡∏≤‡∏£‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤)
10. [‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢](#10-‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢)

---

## 1. ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö

‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ (Project Tracker) ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏î‡πâ‡∏ß‡∏¢ **Django 5.1** ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πà‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ó‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‡πÅ‡∏•‡∏∞‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì

**URL ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:**
```
https://lib.npu.ac.th/projects/
```

**‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå:**

| ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | ‡∏Ñ‡πà‡∏≤ |
|--------|-----|
| IP Address | 110.78.83.102 |
| Domain | lib.npu.ac.th |
| OS | Windows Server 2019 |
| Path ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå | C:\project\project_tracker |
| Port ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô | 8000 (Waitress) |

---

## 2. ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°

### 2.1 ‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå

| ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
|--------|----------|---------|
| Windows Server | 2019 | ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß |
| Python | 3.12+ | ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô |
| Git | ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î | ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö pull ‡πÇ‡∏Ñ‡πâ‡∏î |
| IIS | 10.0 | ‡∏°‡∏≤‡∏Å‡∏±‡∏ö Windows Server |
| ARR Module | 3.0 | ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å Microsoft |
| URL Rewrite Module | 2.1 | ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å Microsoft |
| NSSM | 2.24 | Non-Sucking Service Manager |

### 2.2 ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°

| ‡πÑ‡∏ü‡∏•‡πå | ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
|------|---------|---------|
| cert20xx.pfx | C:\project\project_tracker\cert\ | SSL Certificate *.npu.ac.th |
| pxxx.txt | C:\project\project_tracker\cert\ | ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô PFX |
| .env | C:\project\project_tracker\ | ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ environment |

### 2.3 ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• DNS
- ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô IT ‡∏Å‡∏•‡∏≤‡∏á ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢ ‡πÉ‡∏´‡πâ‡∏ä‡∏µ‡πâ `lib.npu.ac.th ‚Üí 110.78.83.102` ‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£

---

## 3. ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏£‡∏∞‡∏ö‡∏ö

### 3.1 ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° Path-based Routing

‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ **Path-based Routing** ‡∏ã‡∏∂‡πà‡∏á‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡∏ö‡∏ô Domain ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÑ‡∏î‡πâ

```
‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (Browser)
        ‚îÇ
        ‚îÇ  https://lib.npu.ac.th/projects/
        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  IIS 10.0 (Windows Server 2019)     ‚îÇ
‚îÇ  Port 80  ‚Üí Redirect ‡πÑ‡∏õ HTTPS       ‚îÇ
‚îÇ  Port 443 ‚Üí ‡∏£‡∏±‡∏ö HTTPS Request       ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  SSL Termination (cert2026.pfx)     ‚îÇ
‚îÇ  URL Rewrite: /projects/* ‚Üí :8000  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ http://127.0.0.1:8000/
                   ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Waitress (Python WSGI Server)      ‚îÇ
‚îÇ  Listen: 127.0.0.1:8000            ‚îÇ
‚îÇ  Service: ProjectTracker (NSSM)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ
                   ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Django Application                 ‚îÇ
‚îÇ  Settings: config.settings.production‚îÇ
‚îÇ  FORCE_SCRIPT_NAME: /projects       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 3.2 ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Path-based Routing

1. Browser ‡∏™‡πà‡∏á Request: `https://lib.npu.ac.th/projects/dashboard/`
2. IIS ‡∏£‡∏±‡∏ö Request ‡πÅ‡∏•‡∏∞ **‡∏ï‡∏±‡∏î prefix `/projects`** ‡∏≠‡∏≠‡∏Å
3. IIS ‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÉ‡∏´‡πâ Waitress: `http://127.0.0.1:8000/dashboard/`
4. Django ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á URL ‡∏Å‡∏•‡∏±‡∏ö‡πÇ‡∏î‡∏¢‡πÉ‡∏™‡πà `/projects` ‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏∏‡∏Å Link (‡∏ú‡πà‡∏≤‡∏ô `FORCE_SCRIPT_NAME`)
5. ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏´‡πá‡∏ô URL ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: `https://lib.npu.ac.th/projects/dashboard/`

---

## 4. ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á

### 4.1 Clone ‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å GitHub

‡πÄ‡∏õ‡∏¥‡∏î **PowerShell (Administrator)** ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏±‡∏ô:

```powershell
cd C:\
New-Item -ItemType Directory -Path "C:\project" -Force
cd C:\project
git clone https://github.com/azimuthotg/projects_tracker.git project_tracker
cd C:\project\project_tracker
```

### 4.2 ‡∏™‡∏£‡πâ‡∏≤‡∏á Virtual Environment ‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Dependencies

```powershell
python -m venv venv
.\venv\Scripts\pip.exe install -r requirements.txt
```

### 4.3 ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á IIS

```powershell
Install-WindowsFeature -Name `
  Web-Server, Web-WebServer, Web-Common-Http, `
  Web-Static-Content, Web-Http-Errors, Web-Http-Redirect, `
  Web-Health, Web-Http-Logging, `
  Web-Security, Web-Filtering, `
  Web-Performance, Web-Stat-Compression, `
  Web-Mgmt-Tools, Web-Mgmt-Console `
  -IncludeManagementTools
```

> **‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:** ‡∏ö‡∏ô Windows Server ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ `Install-WindowsFeature` ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ `Enable-WindowsOptionalFeature` (‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Windows Client ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)

### 4.4 ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ARR Module

```powershell
New-Item -ItemType Directory -Path "C:\temp" -Force
Invoke-WebRequest `
  -Uri "https://download.microsoft.com/download/E/9/8/E9849D6A-020E-47E4-9FD0-A023E99B54EB/requestRouter_amd64.msi" `
  -OutFile "C:\temp\ARR.msi"
Start-Process msiexec.exe -ArgumentList "/i C:\temp\ARR.msi /quiet" -Wait
```

### 4.5 ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á URL Rewrite Module

```powershell
Invoke-WebRequest `
  -Uri "https://download.microsoft.com/download/1/2/8/128E2E22-C1B9-44A4-BE2A-5859ED1D4592/rewrite_amd64_en-US.msi" `
  -OutFile "C:\temp\urlrewrite.msi"
Start-Process msiexec.exe -ArgumentList "/i C:\temp\urlrewrite.msi /quiet" -Wait
iisreset /restart
```

---

## 5. ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment

### 5.1 ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå .env

‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `C:\project\project_tracker\.env` ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

```env
# Django
SECRET_KEY=‡πÉ‡∏™‡πà-random-key-‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
ALLOWED_HOSTS=localhost,110.78.83.102,lib.npu.ac.th

# HTTPS
HTTPS_ENABLED=True
CSRF_TRUSTED_ORIGINS=https://lib.npu.ac.th

# Path Prefix
SCRIPT_NAME=/projects

# Database (MySQL)
DB_NAME=projects_tracker
DB_USER=xxxx
DB_PASSWORD=‡πÉ‡∏™‡πà-‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô-database
DB_HOST=202.xx.xx.xxx
DB_PORT=3306

# Waitress
WAITRESS_HOST=127.0.0.1
WAITRESS_PORT=8000
WAITRESS_THREADS=8

# NPU AD API
NPU_API_BASE_URL=https://xxx.npu.ac.th/vx/ldap/
NPU_API_AUTH_ENDPOINT=auth_and_get_personnel/
NPU_API_TOKEN=‡πÉ‡∏™‡πà-JWT-token
NPU_API_TIMEOUT=30

# LINE Messaging API
LINE_CHANNEL_ACCESS_TOKEN=
LINE_CHANNEL_SECRET=
```

### 5.2 Generate SECRET_KEY

```powershell
$env:DJANGO_SETTINGS_MODULE = "config.settings.production"
C:\project\project_tracker\venv\Scripts\python.exe -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
```

‡∏ô‡∏≥‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô `SECRET_KEY=` ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `.env`

### 5.3 Collect Static Files

```powershell
$env:DJANGO_SETTINGS_MODULE = "config.settings.production"
C:\project\project_tracker\venv\Scripts\python.exe C:\project\project_tracker\manage.py collectstatic --noinput
```

### 5.4 Run Database Migrations

```powershell
C:\project\project_tracker\venv\Scripts\python.exe C:\project\project_tracker\manage.py migrate
```

---

## 6. ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Windows Service (NSSM + Waitress)

### 6.1 ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Waitress

```powershell
C:\project\project_tracker\venv\Scripts\pip.exe install waitress
```

### 6.2 ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á NSSM

‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î NSSM ‡∏à‡∏≤‡∏Å [nssm.cc](https://nssm.cc) ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡πá‡∏≠‡∏õ‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á dev ‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà `C:\nssm\nssm.exe`

```powershell
New-Item -ItemType Directory -Path "C:\nssm" -Force
# ‡∏Å‡πá‡∏≠‡∏õ nssm.exe ‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà C:\nssm\nssm.exe
```

### 6.3 ‡∏™‡∏£‡πâ‡∏≤‡∏á Service

```powershell
# ‡∏™‡∏£‡πâ‡∏≤‡∏á Service
C:\nssm\nssm.exe install ProjectTracker `
  "C:\project\project_tracker\venv\Scripts\python.exe" `
  "C:\project\project_tracker\deploy\waitress_serve.py"

# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Working Directory
C:\nssm\nssm.exe set ProjectTracker AppDirectory "C:\project\project_tracker"

# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Django Settings
C:\nssm\nssm.exe set ProjectTracker AppEnvironmentExtra "DJANGO_SETTINGS_MODULE=config.settings.production"

# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Log
New-Item -ItemType Directory -Path "C:\project\project_tracker\logs" -Force
C:\nssm\nssm.exe set ProjectTracker AppStdout "C:\project\project_tracker\logs\waitress.log"
C:\nssm\nssm.exe set ProjectTracker AppStderr "C:\project\project_tracker\logs\waitress_error.log"

# Start Service
C:\nssm\nssm.exe start ProjectTracker
```

### 6.4 ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Service

```powershell
C:\nssm\nssm.exe status ProjectTracker
# ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á: SERVICE_RUNNING
```

---

## 7. ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ IIS

### 7.1 Import SSL Certificate

```powershell
Import-PfxCertificate `
  -FilePath "C:\project\project_tracker\cert\cert2026.pfx" `
  -CertStoreLocation Cert:\LocalMachine\My `
  -Password (ConvertTo-SecureString "admina2026*" -AsPlainText -Force) `
  -Exportable
```

### 7.2 ‡∏î‡∏π Thumbprint

```powershell
Get-ChildItem Cert:\LocalMachine\My |
  Where-Object { $_.Subject -like "*.npu.ac.th*" } |
  Select-Object Thumbprint, Subject, NotAfter |
  Format-Table -AutoSize
```

‡∏à‡∏î‡∏Ñ‡πà‡∏≤ **Thumbprint** ‡πÑ‡∏ß‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ

### 7.3 ‡∏£‡∏±‡∏ô Setup Script

```powershell
cd C:\project\project_tracker

# ‡πÅ‡∏õ‡∏•‡∏á Encoding ‡∏Å‡πà‡∏≠‡∏ô (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç!)
$path = ".\deploy\iis\setup_iis.ps1"
$content = [System.IO.File]::ReadAllText($path, [System.Text.Encoding]::UTF8)
$utf8Bom = New-Object System.Text.UTF8Encoding $true
[System.IO.File]::WriteAllText($path, $content, $utf8Bom)

# ‡∏£‡∏±‡∏ô Script
.\deploy\iis\setup_iis.ps1 -CertThumbprint "‡πÉ‡∏™‡πà-THUMBPRINT-‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà"
```

> **‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:** ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏á Encoding ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏™‡∏°‡∏≠ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ Script ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏ô Linux (UTF-8 ‡πÑ‡∏°‡πà‡∏°‡∏µ BOM) ‡πÅ‡∏ï‡πà Windows PowerShell ‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô Windows-1252

### 7.4 ‡πÄ‡∏û‡∏¥‡πà‡∏° Server Variables (‡∏ñ‡πâ‡∏≤ Setup Script ‡∏ó‡∏≥‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à)

```powershell
Import-Module WebAdministration

Add-WebConfiguration -PSPath "MACHINE/WEBROOT/APPHOST" `
    -Filter "system.webServer/rewrite/allowedServerVariables" `
    -Value @{ name = "HTTP_X_FORWARDED_PROTO" }

Add-WebConfiguration -PSPath "MACHINE/WEBROOT/APPHOST" `
    -Filter "system.webServer/rewrite/allowedServerVariables" `
    -Value @{ name = "HTTP_X_REAL_IP" }

iisreset /restart
```

### 7.5 Copy web.config

```powershell
New-Item -ItemType Directory -Path "C:\iis_root" -Force
Copy-Item "C:\project\project_tracker\deploy\iis\web.config" "C:\iis_root\web.config" -Force
```

---

## 8. ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö

### 8.1 ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Waitress (‡∏†‡∏≤‡∏¢‡πÉ‡∏ô)

```powershell
Invoke-WebRequest -Uri "http://127.0.0.1:8000/" -UseBasicParsing
# ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö Response (400 ‡∏´‡∏£‡∏∑‡∏≠ 302 ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥)
```

### 8.2 ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ú‡πà‡∏≤‡∏ô Browser

‡πÄ‡∏õ‡∏¥‡∏î Browser ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ç‡πâ‡∏≤:

| URL | ‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á |
|-----|-------------|
| `http://lib.npu.ac.th/projects/` | Redirect ‡πÑ‡∏õ HTTPS ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ |
| `https://lib.npu.ac.th/projects/` | ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤ Login ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏°‡πà‡∏Å‡∏∏‡∏ç‡πÅ‡∏à üîí |

### 8.3 ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Login

- Username: `xxxx`
- Password: `xxxxxxx4`
- ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà Dashboard ‡πÑ‡∏î‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à

---

## 9. ‡∏Å‡∏≤‡∏£‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤

### 9.1 ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á Service ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢

```powershell
# ‡∏î‡∏π‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
C:\nssm\nssm.exe status ProjectTracker

# Restart (‡∏´‡∏•‡∏±‡∏á git pull ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç .env)
C:\nssm\nssm.exe restart ProjectTracker

# Stop / Start
C:\nssm\nssm.exe stop ProjectTracker
C:\nssm\nssm.exe start ProjectTracker
```

### 9.2 ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÇ‡∏Ñ‡πâ‡∏î

```powershell
cd C:\project\project_tracker
git pull origin master
C:\project\project_tracker\venv\Scripts\python.exe manage.py migrate
C:\project\project_tracker\venv\Scripts\python.exe manage.py collectstatic --noinput
C:\nssm\nssm.exe restart ProjectTracker
```

### 9.3 ‡∏î‡∏π Log

```powershell
# Log ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
Get-Content "C:\project\project_tracker\logs\waitress.log" -Tail 50

# Log Error
Get-Content "C:\project\project_tracker\logs\waitress_error.log" -Tail 50

# ‡∏î‡∏π Log ‡πÅ‡∏ö‡∏ö Real-time
Get-Content "C:\project\project_tracker\logs\waitress_error.log" -Wait
```

### 9.4 SSL Certificate

- **‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏:** xx xxx 2570
- **‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡πà‡∏≠‡∏ô:** ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 30 ‡∏ß‡∏±‡∏ô
- **‡πÑ‡∏ü‡∏•‡πå:** `C:\project\project_tracker\cert\xxxx`
- **‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô:** ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô `C:\project\project_tracker\cert\xxxx`

---

## 10. ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢

| ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£ | ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏ | ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ |
|-------|--------|---------|
| **502 Bad Gateway** | Waitress ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ô | `C:\nssm\nssm.exe start ProjectTracker` |
| **400 Bad Request** | `lib.npu.ac.th` ‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô ALLOWED_HOSTS | ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `.env` ‡πÅ‡∏•‡πâ‡∏ß restart service |
| **500.19 Config Error** | URL Rewrite ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á | ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á URL Rewrite Module |
| **500.50 URL Rewrite Error** | Server Variable ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï | ‡πÄ‡∏û‡∏¥‡πà‡∏° `HTTP_X_FORWARDED_PROTO` ‡πÉ‡∏ô allowedServerVariables |
| **404 ‡∏´‡∏ô‡πâ‡∏≤ Login** | `FORCE_SCRIPT_NAME` ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô | ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `SCRIPT_NAME=/projects` ‡πÉ‡∏ô `.env` |
| **Static files ‡∏´‡∏≤‡∏¢** | ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ô collectstatic | ‡∏£‡∏±‡∏ô `manage.py collectstatic --noinput` |
| **CSRF Error** | ‡πÑ‡∏°‡πà‡∏°‡∏µ `CSRF_TRUSTED_ORIGINS` | ‡πÄ‡∏û‡∏¥‡πà‡∏° `CSRF_TRUSTED_ORIGINS=https://lib.npu.ac.th` ‡πÉ‡∏ô `.env` |
| **Script encoding error** | PowerShell ‡∏≠‡πà‡∏≤‡∏ô UTF-8 ‡∏ú‡∏¥‡∏î | ‡πÅ‡∏õ‡∏•‡∏á Encoding ‡∏î‡πâ‡∏ß‡∏¢ UTF8 BOM ‡∏Å‡πà‡∏≠‡∏ô‡∏£‡∏±‡∏ô script |

---

## ‡∏†‡∏≤‡∏Ñ‡∏ú‡∏ô‡∏ß‡∏Å ‚Äî ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç

```
C:\project\project_tracker\
‚îú‚îÄ‚îÄ .env                          ‚Üê Environment variables
‚îú‚îÄ‚îÄ cert\
‚îÇ   ‚îú‚îÄ‚îÄ certxxxx.pfx             ‚Üê SSL Certificate
‚îÇ   ‚îî‚îÄ‚îÄ xxxx.txt                 ‚Üê ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô PFX
‚îú‚îÄ‚îÄ config\settings\
‚îÇ   ‚îî‚îÄ‚îÄ production.py            ‚Üê Production settings
‚îú‚îÄ‚îÄ deploy\
‚îÇ   ‚îú‚îÄ‚îÄ waitress_serve.py        ‚Üê Entry point ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Waitress
‚îÇ   ‚îî‚îÄ‚îÄ iis\
‚îÇ       ‚îú‚îÄ‚îÄ web.config           ‚Üê IIS Reverse Proxy rules
‚îÇ       ‚îú‚îÄ‚îÄ setup_iis.ps1        ‚Üê IIS Setup script
‚îÇ       ‚îî‚îÄ‚îÄ README_IIS.md        ‚Üê ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ IIS
‚îú‚îÄ‚îÄ logs\
‚îÇ   ‚îú‚îÄ‚îÄ waitress.log             ‚Üê Application log
‚îÇ   ‚îî‚îÄ‚îÄ waitress_error.log       ‚Üê Error log
‚îî‚îÄ‚îÄ static\collected\            ‚Üê Static files (‡∏´‡∏•‡∏±‡∏á collectstatic)

C:\iis_root\
‚îî‚îÄ‚îÄ web.config                   ‚Üê IIS website root

C:\nssm\
‚îî‚îÄ‚îÄ nssm.exe                     ‚Üê Service Manager
```

---

*‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÇ‡∏î‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£ ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ó‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°*
